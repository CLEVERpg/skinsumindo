unit ContaReceber;

interface
                               
uses
  SysUtils, Windows, Messages, Classes, Graphics, Controls, Dialogs, strutils,
  StdCtrls, Forms, DBCtrls, DB, Mask, ComCtrls, ExtCtrls, DBGrids, ShellAPI,
  ZDataset, Variants, ACBrBoleto, 
  sDBLookupComboBox, sPageControl, sPanel, DateUtils, Grids, ZAbstractRODataset,
  sBitBtn, Buttons, sButton, sMaskEdit, sCustomComboEdit, sToolEdit, DBChart,
  sComboBox, sDBDateEdit, TeEngine, Series, TeeProcs, ZAbstractDataset, Chart,
  sLabel, sSpeedButton, sDBEdit, ACBrCNAB, ComObj, sCheckBox, sEdit, sDBMemo,
  sDBNavigator, MaskUtils, sGroupBox, sSkinProvider, sSkinManager;

type
  TFContaReceber = class(TForm)
    PageControl1: TsPageControl;
    PagCadastro: TsTabSheet;
    PagConsulta: TsTabSheet;
    PagRelatorio: TsTabSheet;
    TabSheet4: TsTabSheet;
    Panel4: tspanel;
    Label18: TsLabel;                      
    Label19: TsLabel;
    Label20: TsLabel;
    Label21: TsLabel;
    DBEdit4: TsDBEdit;
    DBEdit5: TsDBEdit;
    DBEdit6: TsDBEdit;                                                               
    DBEdit7: TsDBEdit;
    Panel5: tspanel;
    Label22: TsLabel;
    Label23: TsLabel;
    Label24: TsLabel;
    Label25: TsLabel;
    Label26: TsLabel;
    Label27: TsLabel;
    Label28: TsLabel;
    Label29: TsLabel;
    Label30: TsLabel;
    Label31: TsLabel;
    DBEdit8: TsDBEdit;
    DBEdit9: TsDBEdit;
    DBEdit10: TsDBEdit;
    DBEdit11: TsDBEdit;
    DBEdit12: TsDBEdit;
    DBEdit13: TsDBEdit;
    DBEdit14: TsDBEdit;
    DBEdit15: TsDBEdit;
    DBEdit16: TsDBEdit;
    DBEdit17: TsDBEdit;
    Panel6: tspanel;
    Label32: TsLabel;
    Label33: TsLabel;
    Label34: TsLabel;
    DBEdit18: TsDBEdit;
    DBEdit19: TsDBEdit;
    DBEdit20: TsDBEdit;
    DBGrid1: TDBGrid;
    GroupBox2: TsGroupBox;
    venc: TRadioButton;
    Pagamento: TRadioButton;
    PainelVenc: tspanel;
    Label41: TsLabel;
    Label42: TsLabel;
    Inicial: TsMaskEdit;
    Final: TsMaskEdit;
    Situacao: TRadioGroup;
    PainelRec: tspanel;
    Label43: TsLabel;
    Label44: TsLabel;
    Inicial2: TsMaskEdit;
    Final2: TsMaskEdit;
    BtRelatorio: TSBitbtn;
    Panel2: TsPageControl;
    Duplicatas: TsTabSheet;
    PagLanca: TsTabSheet;
    Label48: TsLabel;
    DBEdit26: TsDBEdit;
    Label56: TsLabel;
    DBEdit28: TsDBEdit;
    GroupBox3: TsGroupBox;
    Label58: TsLabel;
    Label59: TsLabel;
    cini1: TsMaskEdit;
    cfin1: TsMaskEdit;
    BitBtn4: TSBitbtn;
    BitBtn2: TSBitbtn;
    Panel9: tspanel;
    PConsultaTotal: TsPanel;
    Label38: TsLabel;
    Label39: TsLabel;
    Label40: TsLabel;
    DBEdit21: TsDBEdit;
    DBEdit22: TsDBEdit;
    DBEdit23: TsDBEdit;
    Panel11: tspanel;
    Label35: TsLabel;
    Label36: TsLabel;
    Label37: TsLabel;
    Label55: TsLabel;
    Label62: TsLabel;
    EClienteCodigo: TsMaskEdit;
    EDataInicial: TsDateEdit;
    EDataFinal: TsDateEdit;
    Sit: TRadioGroup;
    NCliente: TsEdit;
    BtOk: TSBitbtn;
    BtImprime: TSBitbtn;
    BitBtn1: TSBitbtn;
    btRemessa: TSBitbtn;
    CTipoDup: TsComboBox;
    BtFatura: TSBitbtn;
    BtImpCust: TSBitbtn;
    Label75: TsLabel;
    CbTipoData: TsComboBox;
    Label68: TsLabel;
    Movimento: TRadioButton;
    Label76: TsLabel;
    EDocumento: TsMaskEdit;
    Label17: TsLabel;
    Label64: TsLabel;
    vlr1: TsEdit;
    vlr2: TsEdit;
    PageControl2: TsPageControl;
    TabSheet1: TsTabSheet;
    Panel12: tspanel;
    Label63: TsLabel;
    Label66: TsLabel;
    Label67: TsLabel;
    Label69: TsLabel;
    Label70: TsLabel;
    Label71: TsLabel;
    Label72: TsLabel;
    Label73: TsLabel;
    Label74: TsLabel;
    Label65: TsLabel;
    DBEdit31: TsDBEdit;
    DBEdit32: TsDBEdit;
    DBEdit33: TsDBEdit;
    DBEdit35: TsDBEdit;
    DBEdit36: TsDBEdit;
    DBEdit37: TsDBEdit;
    DBEdit38: TsDBEdit;
    DBEdit39: TsDBEdit;
    DBEdit40: TsDBEdit;
    DBEdit41: TsDBEdit;
    DBEdit3: TsDBEdit;
    TabSheet2: TsTabSheet;
    Panel13: tspanel;
    DBMemo1: TsDBMemo;
    Label78: TsLabel;
    DBEdit42: TsDBEdit;
    DBLFat: TsDBLookupComboBox;
    Label85: TsLabel;
    Panel14: tspanel;
    btsair: TSBitbtn;
    btReplica: TSBitbtn;
    BtCancela: TSBitbtn;
    BtConfirma: TSBitbtn;
    BTConsulta: TSBitbtn;
    BTBaixa: TSBitbtn;
    BtAltera: TSBitbtn;
    BTExclui: TSBitbtn;
    BTInsere: TSBitbtn;
    DBNavigator1: TSDBNavigator;
    BtLimpar: TSBitbtn;
    BTimprimediario: TSBitbtn;
    GroupBox1: TsGroupBox;
    Label8: TsLabel;
    Label9: TsLabel;
    EJuros: TsEdit;
    EMulta: TsEdit;
    Label80: TsLabel;
    DBEdit43: TsDBEdit;
    DBGrid2: TDBGrid;
    Label84: TsLabel;
    DBEdit46: TsDBEdit;
    CBSelecionar: TsCheckBox;
    Label86: TsLabel;
    EDataJuros: TsMaskEdit;
    Label89: TsLabel;
    DBEdit47: TsDBEdit;
    Label91: TsLabel;
    Vendedor: TsMaskEdit;
    ENomeVend: TsEdit;
    Label92: TsLabel;
    DBEdit48: TsDBEdit;
    Label93: TsLabel;
    CBComissao: TsComboBox;
    Label16: TsLabel;
    DBEdit49: TsDBEdit;
    vlrJrs1: TsEdit;
    vlrJrs2: TsEdit;
    lbl1: TsLabel;
    lbl2: TsLabel;
    BBoleto: TSBitbtn;
    Label52: TsLabel;
    dbcontab: TsDBLookupComboBox;
    CBSelecao: TsCheckBox;
    CDescontada: TsCheckBox;
    PDadosGeral: tspanel;
    EditOBSERVACAO: TsDBEdit;
    PCentroCusto: tspanel;
    Panel16: tspanel;
    PLanca: tspanel;
    Panel18: tspanel;
    GLanca: TDBGrid;
    Label49: TsLabel;
    Label50: TsLabel;
    Label51: TsLabel;
    TotNota: TsEdit;
    TotLanca: TsEdit;
    Saldo: TsEdit;
    Label45: TsLabel;
    Conta: TsDBEdit;
    DBEdit24: TsDBEdit;
    Label46: TsLabel;
    Histo: TsDBEdit;
    DBEdit25: TsDBEdit;
    Label47: TsLabel;
    Valor: TsDBEdit;
    BtInclui: TSBitbtn;
    BtCancLanca: TSBitbtn;
    BtConfLanca: TSBitbtn;
    Panel20: tspanel;
    Panel7: tspanel;
    Button1: TsSpeedButton;
    Panel3: tspanel;
    Label10: TsLabel;
    Label11: TsLabel;
    Label14: TsLabel;
    Label53: TsLabel;
    Label60: TsLabel;
    EDT_RECEB: TsDBDateEdit;
    EditVL_RECEB: TsDBEdit;
    EditJUROS: TsDBEdit;
    DBEdit29: TsDBEdit;
    numero: TsDBLookupComboBox;
    BTExcLanc: TSBitbtn;
    BTAltLanc: TSBitbtn;
    Panel21: tspanel;
    Panel1: tspanel;
    Label1: TsLabel;
    Label2: TsLabel;
    Label3: TsLabel;
    EditNUM_NOTA: TsDBEdit;
    EditCODCLI: TsDBEdit;
    EditNUM_DUPL: TsDBEdit;
    DBEdit1: TsDBEdit;
    Panel8: tspanel;
    DBGrid3: TDBGrid;
    Panel17: tspanel;
    Vezes: TsLabel;
    Label57: TsLabel;
    Parc: TsEdit;
    Intervalo: TsEdit;
    CBDtFixa: TsCheckBox;
    confirmarep: TSBitbtn;
    BtCancelarep: TSBitbtn;
    Label90: TsLabel;
    DBEdit2: TsDBEdit;
    Label95: TsLabel;
    EObs: TsEdit;
    Label97: TsLabel;
    ENossoNumero: TsEdit;
    Label82: TsLabel;
    DBEdit50: TsDBEdit;
    BitBtn3: TSBitbtn;
    GResumoCliente: TDBGrid;
    BParcial: TSBitbtn;
    GParcial: TDBGrid;
    Panel22: tspanel;
    BitBtn5: TSBitbtn;
    DBEdit52: TsDBEdit;
    Label99: TsLabel;
    DBLocalizador: TsDBLookupComboBox;
    Label100: TsLabel;
    EdArqRemessa: TsEdit;
    GCurvaABC: TDBGrid;
    BtCurva: TSBitbtn;
    ENotaFiscal: TsEdit;
    Label101: TsLabel;
    PagDados: TsPageControl;
    TabSheet3: TsTabSheet;
    PVencimento: tspanel;
    BAbrirRemessa: TSBitbtn;
    Btrecibo: TSBitbtn;
    BtInformacao: TSBitbtn;
    BPorCliente: TSBitbtn;
    DBEdit53: TsDBEdit;
    Label102: TsLabel;
    Label104: TsLabel;
    DBLPrevisao: TsDBLookupComboBox;
    BTMultiplo: TSBitbtn;
    CSemRemessa: TsCheckBox;
    DBEdit54: TsDBEdit;
    DBEdit55: TsDBEdit;
    Label105: TsLabel;
    Label106: TsLabel;
    DBEdit56: TsDBEdit;
    DBEdit57: TsDBEdit;
    Label107: TsLabel;
    Label108: TsLabel;
    DBLCidade: TsDBLookupComboBox;
    Label109: TsLabel;
    LblClienteVinculado: TsLabel;
    MEClienteVinculado: TsMaskEdit;
    MEClienteVinculadoNome: TsEdit;
    CComBoleto: TsCheckBox;
    Panel15: TsPanel;
    Shape1: TShape;
    Label87: TsLabel;
    Label88: TsLabel;
    Shape2: TShape;
    Label94: TsLabel;
    Shape3: TShape;
    LRegistro: TsLabel;
    BAlterarFormaPagamento: TsBitBtn;
    sBitBtn1: TsBitBtn;
    EUsuBaixa: TsDBLookupComboBox;
    Label113: TsLabel;
    Label114: TsLabel;
    CBArquivoRetorno: TsComboBox;
    sTabSheet1: TsTabSheet;
    sPanel23: TsPanel;
    BAnaliseGraficaOk: TsSpeedButton;
    BAnaliseGraficaFechar: TsSpeedButton;
    sPanel31: TsPanel;
    sLabel1: TsLabel;
    sLabel2: TsLabel;
    EAnaliseDataInicial: TsDateEdit;
    EAnaliseDataFinal: TsDateEdit;
    sPanel15: TsPanel;
    sPanel16: TsPanel;
    LAberto30: TsLabel;
    sLabel4: TsLabel;
    sPanel17: TsPanel;
    LAberto60: TsLabel;
    sLabel6: TsLabel;
    sPanel21: TsPanel;
    LValorAtraso: TsLabel;
    sLabel5: TsLabel;
    sPanel22: TsPanel;
    LAberto90: TsLabel;
    sLabel7: TsLabel;
    sPanel28: TsPanel;
    LVencerHoje: TsLabel;
    sLabel11: TsLabel;
    sPanel29: TsPanel;
    LPagoMesAtual: TsLabel;
    sLabel15: TsLabel;
    sPanel1: TsPanel;
    LAberto7: TsLabel;
    sLabel8: TsLabel;
    sPanel2: TsPanel;
    sPanel5: TsPanel;
    LValorJuros: TsLabel;
    sLabel14: TsLabel;
    sPanel3: TsPanel;
    LpagoComAtrasoPorcentagem: TsLabel;
    sLabel9: TsLabel;
    DBChart2: TDBChart;
    HorizBarSeries1: THorizBarSeries;
    DBChart1: TDBChart;
    Series1: THorizBarSeries;
    sPanel4: TsPanel;
    LTaxaInadimplencia: TsLabel;
    sLabel10: TsLabel;
    sPanel6: TsPanel;
    LTicketMedio: TsLabel;
    sLabel12: TsLabel;
    sPanel7: TsPanel;
    LTaxaCrescimento: TsLabel;
    sLabel13: TsLabel;
    sPanel8: TsPanel;
    LTaxaCrescimentoProporcional: TsLabel;
    sLabel16: TsLabel;
    DBChart3: TDBChart;
    HorizBarSeries2: THorizBarSeries;
    Label115: TsLabel;
    EProtocolo: TsEdit;
    sTabSheet2: TsTabSheet;
    sDBEdit1: TsDBEdit;
    sDBEdit2: TsDBEdit;
    sLabel3: TsLabel;
    sLabel17: TsLabel;
    sLabel18: TsLabel;
    sLabel19: TsLabel;
    sDBEdit3: TsDBEdit;
    sDBEdit4: TsDBEdit;
    sLabel20: TsLabel;
    sDBEdit5: TsDBEdit;
    sLabel21: TsLabel;
    sDBEdit6: TsDBEdit;
    sDBEdit7: TsDBEdit;
    sLabel22: TsLabel;
    sDBEdit8: TsDBEdit;
    sLabel23: TsLabel;
    sTabSheet3: TsTabSheet;
    sLabel24: TsLabel;
    DBDetalhamento: TsDBMemo;
    BQuebraDuplicata: TsBitBtn;
    BJuroDetalhado: TsBitBtn;
    Label118: TsLabel;
    Shape4: TShape;
    LAntecipacao: TsLabel;
    EAntecipacao: TsDBEdit;
    EDuplicata: TsEdit;
    Label119: TsLabel;
    LEnviado: TsLabel;
    sPanel13: TsPanel;
    Label120: TsLabel;
    DBLinhaDigitavel: TsDBEdit;
    BCopiarLinhaDigitavel: TsBitBtn;
    sPanel11: TsPanel;
    Label13: TsLabel;
    Label61: TsLabel;
    Label77: TsLabel;
    Label98: TsLabel;
    EditTOT_RECEB: TsDBEdit;
    DBEdit30: TsDBEdit;
    DBEdit34: TsDBEdit;
    DBEdit51: TsDBEdit;
    Label121: TsLabel;
    Shape5: TShape;
    sPanel14: TsPanel;
    PAnexos: TsPanel;
    BtExcluiDoc: TsSpeedButton;
    BtIncluiDoc: TsSpeedButton;
    GAnexo: TDBGrid;
    BtAbreDoc: TsSpeedButton;
    Label122: TsLabel;
    sDBEdit9: TsDBEdit;
    BLimitado: TsBitBtn;
    sDBEdit10: TsDBEdit;
    sLabel25: TsLabel;
    BReceberDuplicata: TsBitBtn;
    CBEmail: TsComboBox;
    LEmail: TsLabel;
    sPanel18: TsPanel;
    Label12: TsLabel;
    EditOBS: TsDBMemo;
    sPanel19: TsPanel;
    sPanel9: TsPanel;
    sPanel10: TsPanel;
    Label6: TsLabel;
    Label81: TsLabel;
    EditVL_DUP: TsDBEdit;
    DBEdit44: TsDBEdit;
    PJuros: TsPanel;
    Label116: TsLabel;
    DBEdit27: TsDBEdit;
    sPanel12: TsPanel;
    Label83: TsLabel;
    DBEdit45: TsDBEdit;
    sDBEdit11: TsDBEdit;
    sLabel26: TsLabel;
    BAlterarDataVencimento: TsBitBtn;
    LTipoEnvioBoleto: TsLabel;
    CBTipoEnvioBoleto: TsComboBox;
    BConsultaAPI: TsBitBtn;
    sPanel20: TsPanel;
    Label7: TsLabel;
    Label15: TsLabel;
    Label96: TsLabel;
    Label103: TsLabel;
    Label110: TsLabel;
    Label111: TsLabel;
    Label112: TsLabel;
    Label117: TsLabel;
    EditSIT: TsDBEdit;
    DBLookupComboBox3: TsDBLookupComboBox;
    DBLVendedor: TsDBLookupComboBox;
    DBLPrevisaoCR: TsDBLookupComboBox;
    DBEComissaoPercentual: TsDBEdit;
    DBEdit59: TsDBEdit;
    DBEdit58: TsDBEdit;
    sDBLookupComboBox2: TsDBLookupComboBox;
    Label5: TsLabel;
    Label4: TsLabel;
    Label54: TsLabel;
    Label79: TsLabel;
    EditDT_MOV: TsDBDateEdit;
    EditDT_VENC: TsDBDateEdit;
    DBLEmpresa: TsDBLookupComboBox;
    sDBLookupComboBox1: TsDBLookupComboBox;
    ShapeJudicial: TShape;
    LJudicial: TsLabel;
    PAssessoriaJudicial: TsPanel;
    sLabel27: TsLabel;
    DBJudicial: TsDBLookupComboBox;
    sSkinManager1: TsSkinManager;
    sSkinProvider1: TsSkinProvider;

  private
    { private declarations }
  public
    { public declarations }
    criterio, queryTotais: TStringList;
    codbco, nrafazer, X: integer;
    S, TotalN, TotalL: Real;
    nomefor, filtro: string; //scriptselecionar
  end;

var
  FContaReceber: TFContaReceber;
  Baixa, Altera, Pesq, Excluir, Apag: Boolean;
  caminhoanexo: string;
  pedirConfirmacaoCancelamento : boolean = true;

implementation

uses
  DMParametro;

{$R *.DFM}


end.

